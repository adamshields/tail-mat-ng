<nav class="mat-elevation-z8 relative z-10 border-b border-on-surface-variant !bg-primary w-full">
  <div class="flex items-center px-4 py-2 w-full">
    <!-- Logo -->
    <div class="flex items-center">
      <a [routerLink]="['/']" class="inline-flex items-center hover:text-inverse-primary text-on-primary">
        <span class="text-lg mr-1 font-semibold">APP</span>
        <mat-icon class="text-2xl leading-none">bolt</mat-icon>
      </a>
    </div>

    <!-- Main Navigation (Hidden on Mobile, Inline on MD+) -->
    <div class="hidden md:flex ml-4 flex-wrap">
      @for (item of menuItems; track item) {
      @if (!item.subItems) {
      <button [routerLink]="[item.route]"
        class="flex items-center text-sm py-2 px-3 hover:text-inverse-primary text-on-primary">
        <mat-icon class="text-base">{{ item.icon }}</mat-icon>
        <span class="ml-1">{{ item.label }}</span>
      </button>
      }
      @else {
      <button [matMenuTriggerFor]="menu"
        class="flex items-center text-sm py-2 px-3 hover:text-inverse-primary text-on-primary">
        <mat-icon class="text-base">{{ item.icon }}</mat-icon>
        <span class="ml-1">{{ item.label }}</span>
        <mat-icon>arrow_drop_down</mat-icon>
      </button>

      <mat-menu #menu="matMenu">
        @for (subItem of item.subItems; track subItem) {
        <a mat-menu-item [routerLink]="[item.route, subItem.route]">
          <mat-icon>{{ subItem.icon }}</mat-icon>
          <span>{{ subItem.label }}</span>
        </a>
        }
      </mat-menu>
      }
      }
    </div>

    <!-- Application Search (Always Visible) -->
    @if (applications) {
    <div class="flex-grow flex justify-center md:justify-end px-4">
      <form class="w-full max-w-xs md:max-w-sm bg-on-primary rounded-lg density-3xs">
        <mat-form-field subscriptSizing="dynamic" appearance="outline" class="w-full">
          <mat-icon matPrefix class="mr-2">search</mat-icon>
          <input type="text" placeholder="Search Applications" aria-label="Search Applications" matInput>
        </mat-form-field>
      </form>
    </div>
    }

    <!-- Mobile Menu + Profile & Theme Toggle (Only on Mobile) -->
    <div class="flex items-center md:hidden space-x-2">
      <!-- Theme Toggle -->
      <button mat-icon-button class="!text-on-primary" aria-label="Change theme" [matMenuTriggerFor]="themeMenu">
        <mat-icon>{{ (isDark$ | async) === true ? "dark_mode" : "light_mode" }}</mat-icon>
      </button>

      <mat-menu #themeMenu="matMenu">
        <button mat-menu-item (click)="changeTheme('auto')">System</button>
        <button mat-menu-item (click)="changeTheme('light')">Light</button>
        <button mat-menu-item (click)="changeTheme('dark')">Dark</button>
      </mat-menu>

      <!-- Profile Button -->
      <button mat-icon-button class="!text-on-primary" [matMenuTriggerFor]="profileMenu">
        <mat-icon>account_circle</mat-icon>
      </button>

      <mat-menu #profileMenu="matMenu">
        <button mat-menu-item>
          <mat-icon>person</mat-icon>
          <span>User Profile</span>
        </button>
        <button mat-menu-item>
          <mat-icon>settings</mat-icon>
          <span>Account Settings</span>
        </button>
        <mat-divider></mat-divider>
        <button mat-menu-item>
          <mat-icon>exit_to_app</mat-icon>
          <span>Logout</span>
        </button>
      </mat-menu>

      <!-- Mobile Menu Button -->
      <button class="text-on-primary focus:outline-none" (click)="mobileMenuOpen = !mobileMenuOpen">
        <mat-icon>{{ mobileMenuOpen ? 'close' : 'menu' }}</mat-icon>
      </button>
    </div>

    <!-- Right Side Icons & Actions (Desktop Only) -->
    <div class="hidden md:flex items-center space-x-3">
      <!-- Theme Toggler -->
      <button mat-icon-button class="!text-on-primary" aria-label="Change theme" [matMenuTriggerFor]="themeMenu"
        [matTooltip]="themeManager.getStoredTheme()">
        <mat-icon>{{ (isDark$ | async) === true ? "dark_mode" : "light_mode" }}</mat-icon>
      </button>

      <mat-menu #themeMenu="matMenu">
        <button mat-menu-item (click)="changeTheme('auto')">System</button>
        <button mat-menu-item (click)="changeTheme('light')">Light</button>
        <button mat-menu-item (click)="changeTheme('dark')">Dark</button>
      </mat-menu>

      <!-- Profile Button -->
      <button mat-icon-button class="!text-on-primary" [matMenuTriggerFor]="profileMenu" [matTooltip]="userName">
        <mat-icon>account_circle</mat-icon>
      </button>

      <mat-menu #profileMenu="matMenu">
        <button mat-menu-item>
          <mat-icon>person</mat-icon>
          <span>User Profile</span>
        </button>
        <button mat-menu-item>
          <mat-icon>settings</mat-icon>
          <span>Account Settings</span>
        </button>
        <mat-divider></mat-divider>
        <button mat-menu-item>
          <mat-icon>exit_to_app</mat-icon>
          <span>Logout</span>
        </button>
      </mat-menu>
    </div>
  </div>

  <!-- Mobile Navigation Menu (Hidden by Default) -->
  @if (mobileMenuOpen) {
  <div class="md:hidden flex flex-col space-y-2 px-4 py-2 border-t border-on-surface-variant">
    @for (item of menuItems; track item) {
    @if (!item.subItems) {
    <button [routerLink]="[item.route]"
      class="flex items-center text-sm py-2 px-3 hover:text-inverse-primary text-on-primary">
      <mat-icon class="text-base">{{ item.icon }}</mat-icon>
      <span class="ml-1">{{ item.label }}</span>
    </button>
    }
    @else {
    <button [matMenuTriggerFor]="menu"
      class="flex items-center text-sm py-2 px-3 hover:text-inverse-primary text-on-primary">
      <mat-icon class="text-base">{{ item.icon }}</mat-icon>
      <span class="ml-1">{{ item.label }}</span>
      <mat-icon>arrow_drop_down</mat-icon>
    </button>

    <mat-menu #menu="matMenu">
      @for (subItem of item.subItems; track subItem) {
      <a mat-menu-item [routerLink]="[item.route, subItem.route]">
        <mat-icon>{{ subItem.icon }}</mat-icon>
        <span>{{ subItem.label }}</span>
      </a>
      }
    </mat-menu>
    }
    }
  </div>
  }
</nav>

<div class="grid grid-rows-4 grid-flow-col gap-4">
  <div>01</div>
  <div>01</div>
  <div>01</div>
  <div>01</div>
  <div>01</div>
  <div>01</div>
  <div>01</div>
  <div>01</div>
  <!-- ... -->
  <div>09</div>
</div>

<div class="p-4 flex flex-col md:flex-row items-start md:items-center justify-between gap-4">
  <!-- Left Section: Design Details (capped width so text wraps) -->
  <div class="min-w-0 max-w-md">
    @if (data.design) {
      <div class="text-2xl font-semibold text-gray-900">Design Details:</div>
      <div class="text-sm text-gray-700 break-words">
        Design Name: {{ data.design.name }}
      </div>
    } @else {
      <div class="text-2xl">Loading...</div>
    }
  </div>

  <div class="flex flex-col sm:flex-row gap-2">
    @if (data.appl) {
      <button
        class="btn-dense max-w-[240px] w-full"
        [routerLink]="['/applications', data.appl.id]"
        matTooltip="Navigate to {{ data.appl.ait }} - {{ data.appl.name }}"
        matTooltipPosition="below">
        <mat-icon class="btn-dense-icon top-0.5">arrow_outward</mat-icon>
        <span class="truncate flex-1 text-left leading-none">
          Application: {{ data.appl.ait }} - {{ data.appl.name }}
        </span>
      </button>
    }
    @if (data.design) {
      <button
        class="btn-dense max-w-[260px] w-full"
        [routerLink]="['/projects', data.design.projectId]"
        matTooltip="Navigate to {{ data.design.projectName }}"
        matTooltipPosition="below">
        <mat-icon class="btn-dense-icon top-0.5">arrow_outward</mat-icon>
        <span class="truncate flex-1 text-left leading-none">
          Project: {{ data.design.projectName }}
        </span>
      </button>
    }
  </div>



  <!-- Right Section: Version & Status -->
  @if (data.design) {
    <div class="flex flex-col items-end min-w-max">
      <div class="text-lg font-semibold text-gray-900">
        Version: {{ data.design.version }}
      </div>
      <div class="text-lg px-4 py-2 text-center border border-solid rounded-md mt-2 transitions"
           [class.bg-[#efacaf]]="isPast(data.design)"
           [class.bg-[#80efac]]="isPresent(data.design)"
           [class.bg-[#93c5fd]]="isFuture(data.design)">
        {{ data.design.status }}
      </div>
    </div>
  }
</div>




<header class="border-b border-gray-200 bg-gray-50 dark:border-gray-800 dark:bg-gray-900">
  <div class="mx-auto px-4 py-8 sm:px-6 sm:py-12 lg:px-8">
    <div class="flex flex-col items-start gap-4 md:flex-row md:items-center md:justify-between">
      <div>
        <h1 class="text-2xl font-bold text-gray-900 sm:text-3xl dark:text-white">Blog Posts</h1>

        <p class="mt-1.5 text-sm text-gray-500 dark:text-gray-400">
          Lorem ipsum dolor, sit amet consectetur adipisicing elit. Iure, recusandae.
        </p>
      </div>

      <div class="flex items-center gap-4">
        <button
          class="inline-flex items-center justify-center gap-1.5 rounded-sm border border-gray-200 bg-white px-5 py-3 text-gray-900 transition hover:text-gray-700 focus:ring-3 focus:outline-hidden dark:border-gray-800 dark:bg-gray-900 dark:text-white dark:hover:text-gray-200"
          type="button"
        >
          <span class="text-sm font-medium"> View Website </span>

          <svg
            xmlns="http://www.w3.org/2000/svg"
            class="size-4"
            fill="none"
            viewBox="0 0 24 24"
            stroke="currentColor"
            stroke-width="2"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"
            />
          </svg>
        </button>

        <button
          class="inline-block rounded-sm bg-indigo-600 px-5 py-3 text-sm font-medium text-white transition hover:bg-indigo-700 focus:ring-3 focus:outline-hidden"
          type="button"
        >
          Create Post
        </button>
      </div>
    </div>
  </div>
</header>
<mat-divider></mat-divider>
<!-- </div> -->
<div class="flex">
  <!-- <side-menu class="flex-none" [routes]="menuItems"></side-menu> -->
  <mat-divider vertical="true"></mat-divider>
  <div class="m-4 flex-1">
    <ng-content class="flex-1"></ng-content>
    <router-outlet></router-outlet>
  </div>
</div>
