/**
 * Custom Title Strategy that creates hierarchical page titles reflecting the full path:
 * /applications/1234/designs/10/server -> "APP 1234 - DESIGN 10 - SERVERS"
 * /applications/1234/designs/10/server/1 -> "APP 1234 - DESIGN 10 - SERVER 1"
 */
@Injectable()
export class AutoTitleStrategy extends TitleStrategy {
  private readonly appName = 'Adam';

  override updateTitle(routerState: RouterStateSnapshot): void {
    if (!routerState) return;
    const segments = routerState.url.split('/').filter(Boolean);
    
    // Get important segments from URL
    const appId = segments[1];
    const designId = segments[segments.indexOf('designs') + 1];
    const isResourceDetail = this.isNumeric(segments[segments.length - 1]);
    const resourceType = isResourceDetail ? segments[segments.length - 2] : segments[segments.length - 1];

    let title = `APP ${appId} - DESIGN ${designId}`;

    // Add resource information
    if (isResourceDetail) {
      const resourceId = segments[segments.length - 1];
      title += ` - ${this.formatTitle(resourceType)} ${resourceId}`;
    } else {
      title += ` - ${this.formatTitle(resourceType)}S`;
    }

    document.title = `${title} | ${this.appName}`;
  }

  private isNumeric(value: string): boolean {
    return /^\d+$/.test(value);
  }

  private formatTitle(text: string): string {
    return text
      .replace(/([A-Z])/g, ' $1')
      .trim()
      .toUpperCase();
  }
}
